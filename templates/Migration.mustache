-- Migration для {{classname}}
-- {{#description}}{{description}}{{/description}}
-- Generated from OpenAPI specification

CREATE TABLE IF NOT EXISTS {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}s (
{{#vars}}
    {{#isId}}
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    {{/isId}}
    {{^isId}}
    {{#lambda.snake_case}}{{name}}{{/lambda.snake_case}} {{#sqlType}}{{sqlType}}{{/sqlType}}{{^sqlType}}{{#isString}}VARCHAR{{#maxLength}}({{maxLength}}){{/maxLength}}{{^maxLength}}(255){{/maxLength}}{{/isString}}{{#isInteger}}INTEGER{{/isInteger}}{{#isBoolean}}BOOLEAN{{/isBoolean}}{{#isDateTime}}TIMESTAMP{{/isDateTime}}{{#isUuid}}UUID{{/isUuid}}{{/sqlType}}{{#isRequired}} NOT NULL{{/isRequired}}{{#isUnique}} UNIQUE{{/isUnique}},
    {{/isId}}
{{/vars}}
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP
);

{{#vars}}
{{#isUnique}}
{{^isId}}
CREATE UNIQUE INDEX IF NOT EXISTS idx_{{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}s_{{#lambda.snake_case}}{{name}}{{/lambda.snake_case}} ON {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}s({{#lambda.snake_case}}{{name}}{{/lambda.snake_case}});
{{/isId}}
{{/isUnique}}
{{/vars}}

{{#hasRelations}}
{{#vars}}
{{#isForeignKey}}
CREATE INDEX IF NOT EXISTS idx_{{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}s_{{#lambda.snake_case}}{{name}}{{/lambda.snake_case}}_id ON {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}s({{#lambda.snake_case}}{{name}}{{/lambda.snake_case}}_id);
{{/isForeignKey}}
{{/vars}}
{{/hasRelations}}


